<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Додаток для введення книг</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 500px;
            margin: auto;
            padding: 20px;
            background: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        h1, h3 {
            text-align: center;
        }
        form {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }
        input[type="submit"] {
            width: 100%;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        input[type="submit"]:hover {
            background-color: #0056b3;
        }
        ul {
            list-style: none;
            padding: 0;
        }
        li {
            background: #e9ecef;
            margin-bottom: 8px;
            padding: 10px;
            border-radius: 4px;
            display: flex;
        }
        .book-id {
            width: 40px;
            font-weight: bold;
        }
        .book-title {
            flex-grow: 1;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Мій Додаток</h1>
    <form id="bookForm">
        <label for="book-title">Назва книги:</label>
        <input type="text" id="book-title" name="book-title" placeholder="Введіть назву книги">
        <input type="submit" value="Додати книгу">
    </form>

    <div class="book-list">
        <h3>Список книг</h3>
        <ul id="booksList"></ul>
    </div>
</div>

<script>
    // Функція для завантаження книг з localStorage та відображення їх у списку
    function loadBooks() {
        const books = JSON.parse(localStorage.getItem('books')) || [];
        const booksList = document.getElementById('booksList');
        booksList.innerHTML = '';
        books.forEach((book, index) => {
            const li = document.createElement('li');

            // Створення елементу для ID
            const spanId = document.createElement('span');
            spanId.className = 'book-id';
            spanId.textContent = book.id + ".";

            // Створення елементу для назви книги
            const spanTitle = document.createElement('span');
            spanTitle.className = 'book-title';
            spanTitle.textContent = book.title;

            li.appendChild(spanId);
            li.appendChild(spanTitle);

            // При кліку - можливість видалення книги
            li.addEventListener('click', () => deleteBook(index));

            booksList.appendChild(li);
        });
    }

    // Функція для додавання нової книги з унікальним ID
    function addBook(title) {
        const books = JSON.parse(localStorage.getItem('books')) || [];

        // Отримання наступного ID (якщо не встановлено, встановлюємо 1)
        let nextId = localStorage.getItem('bookNextId');
        if (!nextId) {
            nextId = 1;
        } else {
            nextId = parseInt(nextId, 10);
        }

        const newBook = { id: nextId, title };
        books.push(newBook);

        localStorage.setItem('books', JSON.stringify(books));
        localStorage.setItem('bookNextId', nextId + 1);
        loadBooks();
    }

    // Функція для видалення книги за індексом
    function deleteBook(index) {
        let books = JSON.parse(localStorage.getItem('books')) || [];
        books.splice(index, 1);
        localStorage.setItem('books', JSON.stringify(books));
        loadBooks();
    }

    // Обробка події надсилання форми з валідацією на дублікати
    document.getElementById('bookForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const bookTitle = document.getElementById('book-title').value.trim();
        if (bookTitle) {
            const books = JSON.parse(localStorage.getItem('books')) || [];
            // Перевірка на дублікати (без врахування регістру)
            const duplicate = books.some(book => book.title.toLowerCase() === bookTitle.toLowerCase());
            if (duplicate) {
                // Запит на підтвердження додавання дубліката
                const confirmAdd = confirm('Книга з такою назвою вже існує. Ви бажаєте додати книгу?');
                if (!confirmAdd) {
                    return;
                }
            }
            addBook(bookTitle);
            document.getElementById('book-title').value = '';
        }
    });

    // Завантаження списку книг при завантаженні сторінки
    loadBooks();
</script>
</body>
</html>
